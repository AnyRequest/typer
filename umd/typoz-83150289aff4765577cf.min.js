!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Typoz=e():t.Typoz=e()}(self,(()=>(()=>{"use strict";var t={d:(e,n)=>{for(var s in n)t.o(n,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:n[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function n(t,e){for(const s of Object.keys(e))"string"==typeof t[s]||"number"==typeof t[s]||"boolean"==typeof t[s]||t[s]instanceof Array?t[s]=e[s]:n(t[s],e[s])}function s(t,e,n){const s=document.createElement(t);return s.innerHTML=e,n&&s.setAttribute(n.name,n.value),s}function i({blink:t,blinkTime:e=1,content:n="",color:s="#56565656",dir:i="vertical",size:r=1,distance:o=.1},h,a=!1){const c=t?"@keyframes cursor-blink { 100% { opacity: 0; } }":"",d=t?`animation: cursor-blink ${e}s steps(2) infinite;`:"animation: none";return a?`[typoz-name${h?`="${h}"`:""}]::before { content: '　'; display: inline-block; height: 1em; width: 1px; user-select: none; pointer-events: none; color: transparent; background-color: transparent; } [typoz-name${h?`="${h}"`:""}] { } [typoz-name${h?`="${h}"`:""}]>[typoz-cursor]::after { box-sizing: content-box; display: inline-block; content: "${n}"; width: 0px; height: 1em; border-left: 1px solid #565656; /* margin-left: ${o}em; */ line-height: inherit;  ${d} }${c}`:`[typoz-name${h?`="${h}"`:""}]::before { content: '　'; display: inline-block; height: 1em; width: 1px; user-select: none; pointer-events: none; color: transparent; background-color: transparent; } [typoz-name${h?`="${h}"`:""}] { } [typoz-name${h?`="${h}"`:""}]::after { display: inline-block; content: "${n}"; ${{vertical:`height: ${r}em; width: calc(${r}em * 0.25);`,horizontal:` width: ${.8*r}em; height: calc(${.8*r}em * 0.35);`}[i]} /* margin-left: ${o}em; */ line-height: inherit; background-color: ${s}; ${d} }${c}`}function r(t){return document.querySelector(t)}function o(t){if(document.head.querySelector("[typoz-styles]"))document.head.querySelector("[typoz-styles]").innerHTML+=t;else{const e=s("style",t);e.setAttribute("typoz-styles",""),document.head.append(e)}}function h(t){return JSON.parse(JSON.stringify(t))}function a(){return"xyxyxx-xyyx-xxy-xxyyxxyxyyxy1xxyyxyxxx0xxyyy".replace(/x|y/g,(t=>{const e=t=>t[Math.floor(Math.random()*t.length)];switch(t){case"x":return e("abcdefghijklmnopqrstuvwxyz");case"y":return e("ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789")}}))}t.d(e,{default:()=>g});class c{static id=0;id;name;typingList=[];config;before=0;element;isStarted=!1;injectStyle;order=0;stop=!1;play;constructor(t,e,n){this.id=++c.id,this.element=t,this.name=a(),this.config=e,this.typingList=n.filter((t=>t&&t.length>0&&t[0].length>0&&t[0][0].length>0)),this.setup()}orderUp(){this.order=(this.order+1)%this.typingList.length||0}setup(){Object.freeze(this.typingList),Object.freeze(this.config),this.element.innerHTML="",this.element.setAttribute("typoz-id",""+this.id),this.element.setAttribute("typoz-name",this.name),this.element.setAttribute("typoz-processed",""),this.injectStyle=i(this.config.style.cursor,this.name)}copyCurrent(){return JSON.parse(JSON.stringify(this.typingList[this.order]))}resume(){this.play(!0),this.stop=!1}pause(){this.stop=!0}clear(){this.isStarted=!1}destroy(){this.pause(),this.clear(),this.element.innerHTML=this.element.typings[0],this.typingList=[]}wait(t=0){return new Promise((e=>{this.stop?this.play=e:setTimeout((()=>{e(!0)}),1e3*t)}))}run(){this.isStarted=!0,this.render()}renderEraseDivide(t){return new Promise((e=>{const n=[...this.element.innerText].map((t=>s("span",t).outerHTML));let i=n.length,r=t.pop();const o=setInterval((async()=>{if(this.stop&&await this.wait(),0===r.length){if(0===t.length)return clearInterval(o),this.element.innerText="",void e(!0);r=t.pop(),i-=1,this.element.innerHTML="",this.element.innerHTML=n.slice(0,i).join("")}else this.element.innerHTML=[...n.slice(0,i-1),s("span",r.pop()).outerHTML].join("")}),1/this.config.speed.erase*100)}))}renderWriteDivide(t){return new Promise((e=>{let n=0;const i=[];let r=t.shift();const o=setInterval((async()=>{this.stop&&await this.wait(),0===r.length?0===t.length?(clearInterval(o),this.element.innerHTML=i.join(""),e(!0)):(r=t.shift(),n+=1):(i[n]=s("span",r.shift()).outerHTML,this.element.innerHTML=i.join(""))}),1/this.config.speed.write*100)}))}renderErase(t){return new Promise((e=>{let n=this.element.innerText.length;const s=this.element.innerText;let i=t.pop();const r=setInterval((async()=>{if(this.stop&&await this.wait(),0===i.length){if(0===t.length)return clearInterval(r),this.element.innerText="",void e(!0);i=t.pop(),n-=1,this.element.innerText=s.slice(0,n)}else this.element.innerText=s.slice(0,n-1)+i.pop()}),1/this.config.speed.erase*100)}))}renderWrite(t){return new Promise((e=>{let n=0;const s=[];let i=t.shift();const r=setInterval((async()=>{this.stop&&await this.wait(),0===i.length?0===t.length?(clearInterval(r),this.element.innerText=s.join(""),e(!0)):(i=t.shift(),n+=1):(s[n]=i.shift(),this.element.innerText=s.join(""))}),1/this.config.speed.write*100)}))}async render(){!1!==this.isStarted&&(this.orderUp(),this.config.mode.divide?(await this.renderWriteDivide([...this.copyCurrent()]),await this.wait(this.config.delay),this.config.mode.erase&&(await this.renderEraseDivide([...this.copyCurrent()]),await this.wait(this.config.delay))):(await this.renderWrite([...this.copyCurrent()]),this.config.mode.erase&&(await this.renderErase([...this.copyCurrent()]),await this.wait(this.config.delay))),this.isStarted&&this.render())}}class d{}class l{onset=["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"];nucleus=["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ","ㅘ","ㅙ","ㅚ","ㅛ","ㅜ","ㅝ","ㅞ","ㅟ","ㅠ","ㅡ","ㅢ","ㅣ"];coda=["","ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"];gapLetterWithWord=18816;startKorPoint=12593;startKorWordPoint=44032;changeOnsetPoint=this.coda.length*this.nucleus.length;korInitializePoint(t){if(!this.isKorean(t))throw new TypeError("required only korean.");return t.charCodeAt(0)-this.startKorWordPoint}onsetIndex(t){return Math.floor(this.korInitializePoint(t)/this.changeOnsetPoint)}nucleusIndex(t){return Math.floor(this.korInitializePoint(t)/this.coda.length%this.nucleus.length)}codeIndex(t){return Math.floor(this.korInitializePoint(t)%this.coda.length)}getOnset(t){return this.onset[this.onsetIndex(t)]}getNucleus(t){return this.nucleus[this.nucleusIndex(t)]}getCoda(t){return this.coda[this.codeIndex(t)]}isKorean(t){return!!String(t).match(/[ㄱ-ㅎ가-힣]/g)}wordToLetters(t){return this.wordToLettersWithEmpty(t).filter((t=>t))}wordToLettersWithEmpty(t){return[this.getOnset(t),this.getNucleus(t),this.getCoda(t)]}getOnsetIndex(t){return this.onset.indexOf(t)}getNucleusIndex(t){return this.nucleus.indexOf(t)}getCodaIndex(t){return this.coda.indexOf(t)}getOnsetCode(t){return this.getOnsetIndex(t)*this.changeOnsetPoint}getNucleusCode(t){return this.getNucleusIndex(t)%this.nucleus.length*this.coda.length}getCodaCode(t){return this.getCodaIndex(t)%this.coda.length}getWordCode(t){let e=0;return t[0]&&(e+=this.getOnsetCode(t[0])),t[1]&&(e+=this.getNucleusCode(t[1])),t[2]&&(e+=this.getCodaCode(t[2])),e+this.startKorWordPoint}lettersToWord(t){const e=this.getWordCode(t),n=String.fromCharCode(e);return 1===t.length?t[0]:n}}class p extends d{koreanParser;constructor(){super(),this.koreanParser=new l}wordToLetters(t){return this.wordToLettersWithEmpty(t).filter((t=>t))}wordToLettersWithEmpty(t){return[t,"",""]}categorizing(t){const e=[];for(const n of t.trim())if(this.koreanParser.isKorean(n)){const t=this.koreanParser.wordToLetters(n);e.push(t)}else{const t=this.wordToLetters(n);e.push(t)}return e}categorizingWithEmpty(t){const e=[];for(const n of t)if(this.koreanParser.isKorean(n)){const t=this.koreanParser.wordToLettersWithEmpty(n);e.push(t)}else{const t=this.wordToLettersWithEmpty(n);e.push(t)}return e}getTypingFlow(t){return t.map((t=>{const e=[];if(t.some(this.koreanParser.isKorean))for(let n=1;n<=t.length;n++){const s=t.slice(0,n),i=this.koreanParser.lettersToWord(s);e.push(i)}else e.push(...t);return e}))}parse(t){if(""!==t){const e=this.categorizing(t);return this.getTypingFlow(e)}return[]}}const u={autoRender:!0,mode:{erase:!0,realTyping:!1,divide:!0},speed:{write:1,erase:5},delay:3,nodes:[],querySelector:".typoz",style:{cursor:{blink:!0,blinkTime:1,content:"",color:"#56565656",dir:"vertical",size:1,distance:.1}}};class f{static instance(t){return new f(t)}static id=0;parser;id;name;config=u;typeNode;taskQueue=[];pointer=0;content=[];constructor(t){this.parser=t}wait(t){return new Promise((e=>{setTimeout((()=>{e(t)}),t)}))}select(t){const e=r(t);return f.id+=1,this.id=f.id,this.typeNode=e,this.name=a(),this}conf(t=u){return t&&n(this.config,t),o(i(this.config.style.cursor,this.name,!0)),this.typeNode.setAttribute("typoz-id",""+this.id),this.typeNode.setAttribute("typoz-name",this.name),this.typeNode.setAttribute("typoz-node-builder",""),this.typeNode.setAttribute("typoz-processed",""),this.typeNode.innerHTML="",this}getCurrentRenderContentLength(){return this.content.length}cursorUpdate(t){this.pointer+t>=0&&this.pointer+t<=this.content.length&&(this.pointer+=t)}pause(t){return this.addTask((async()=>await this.wait(1e3*t))),this}commonWrite(t){this.addTask((async()=>(this.content.splice(this.pointer,0,t),this.cursorUpdate(1),this.renderContent(),await this.wait(1/this.config.speed.write*100))))}replace(t,e){this.addTask((async()=>(this.cursorUpdate(t),this.content.splice(this.pointer,1,e),this.renderContent(),await this.wait(1/this.config.speed.write*100))))}write(t){for(const e of t)if(this.parser.koreanParser.isKorean(e)){const t=this.parser.categorizing(e),n=this.parser.getTypingFlow(t)[0];for(;n.length>0;){const t=n.shift();this.replace(0,t)}this.move(1)}else this.commonWrite(e);return this}erase(t=1){for(let e=0;e<t;e++)this.addTask((async()=>(this.cursorUpdate(-1),this.content.splice(this.pointer,1),this.renderContent(),await this.wait(1/this.config.speed.erase*100))));return this}allErase(){return this.addTask((async()=>{for(;this.content.length>0;)this.cursorUpdate(-1),this.content.pop(),this.renderContent(),await this.wait(1/this.config.speed.erase/5*100);return 1/this.config.speed.erase/5*100})),this}move(t){const e=Math.abs(t),n=Math.floor(Math.abs(t)/t);for(let t=0;t<e;t++)this.addTask((async()=>(this.cursorUpdate(n),this.renderContent(),await this.wait(100*this.config.delay))));return this}addTask(t){this.taskQueue.push(t)}async run(){for(const t of this.taskQueue)await t()}renderContent(){this.typeNode.innerHTML=this.content.map(((t,e)=>s("span",t,e===this.pointer-1?{name:"typoz-cursor",value:""}:void 0).outerHTML)).join("")}}const g=class{defaultConfig=u;parser;node(){return f.instance(this.parser)}config;typeNodes=[];constructor(){this.parser=new p}initialize(){this.config=h(this.defaultConfig)}destroy(){this.config=h(this.defaultConfig),c.id=0,f.id=0;for(const t of this.typeNodes)t.destroy();this.typeNodes=[]}globalConfig(t=u){t&&n(this.config,t),this.config.autoRender&&this.render()}convert(t){return this.parser.parse(t)}bulkConvert(t){const e=[];for(const n of t)e.push(this.convert(n));return e}resume(t){if(null!=t&&"string"==typeof t){const e=this.typeNodes.find((e=>e.name===t));e&&e.resume()}else for(const t of this.typeNodes)t.resume()}pause(t){if(null!=t&&"string"==typeof t){const e=this.typeNodes.find((e=>e.name===t));e&&e.pause()}else for(const t of this.typeNodes)t.pause()}defaultRender(){const t=(e=this.config.querySelector,document.querySelectorAll([].concat(e).join(",")));var e;for(const e of[...new Set(t)]){const t=e.innerText.trim();""!==t&&(Object.hasOwn(e,"typings")||(e.typings=[]),e.typings.push(t.trim()));const n=this.convert(t),s=new c(e,e.typozConfig||JSON.parse(JSON.stringify(this.defaultConfig)),[n]);this.typeNodes.push(s)}}manualRender(t){for(const e of[...new Set(t)]){const t=e.innerText.trim();""!==t&&(Object.hasOwn(e,"typings")||(e.typings=[]),e.typings.push(t.trim()));const n=this.convert(t),s=new c(e,e.typozConfig||JSON.parse(JSON.stringify(this.defaultConfig)),[n]);this.typeNodes.push(s)}}getConfigNodes(){return this.config.nodes.length>0?this.config.nodes.reduce(((t,{select:e,words:s,config:i})=>{const o=r(e);if(o){if(o.setAttribute,!Object.hasOwn(o,"typozConfig")){const t=JSON.parse(JSON.stringify(this.defaultConfig));n(t,i||this.config),o.typozConfig=t}const e=function(t){return t.innerText.trim()}(o);""!==e&&(Object.hasOwn(o,"typings")||(o.typings=[]),o.typings.push(e.trim())),s?.length>0&&o.typings.push(...s.map((t=>t.trim()))),t.push(o)}else console.error(new SyntaxError("not found element.",{cause:e}));return t}),[]):[]}nodesRender(){const t=this.getConfigNodes();for(const e of[...new Set(t)]){const t=[e.innerText.trim()];e.typings?.length>0&&t.push(...e.typings);const n=new c(e,e.typozConfig||JSON.parse(JSON.stringify(this.defaultConfig)),this.bulkConvert([...new Set(t)]));this.typeNodes.includes(n)||this.typeNodes.push(n)}}render(t){let e="";e+=i(this.config.style.cursor),this.defaultRender(),this.manualRender(t),this.nodesRender();for(const t of this.typeNodes)e+=t.injectStyle+"\n",t.run();o(e)}};return e.default})()));