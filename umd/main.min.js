!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.typoz=t():(e.typoz=e.typoz||{},e.typoz.main=t())}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{KoreanParser:()=>s,Parser:()=>i,Typoz:()=>a,default:()=>h});class n{id;name;typingList=[];config;before=0;element;isStarted=!1;injectStyle;order=0;stop=!1;play;constructor(e,t,n,r){this.id=e,this.element=t,this.name=this.createName(),this.config=n,this.typingList=r.filter((e=>e&&e.length>0&&e[0].length>0&&e[0][0].length>0)),this.setup()}createName(){return"xyxyxx-xyyx-xxy-xxyyxxyxyyxy1xxyyxyxxx0xxyyy".replace(/x|y/g,(e=>{const t=e=>e[Math.floor(Math.random()*e.length)];switch(e){case"x":return t("abcdefghijklmnopqrstuvwxyz");case"y":return t("ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789")}}))}orderUp(){this.order=(this.order+1)%this.typingList.length}setup(){Object.freeze(this.typingList),this.element.innerHTML="",this.element.dataset.typerId=""+this.id,this.element.dataset.typerName=this.name,this.element.setAttribute("typer-processed",""),this.injectStyle=`[data-typer-name="${this.name}"]::before { content: '　'; display: inline-block; height: 1em; width: 1px; user-select: none; pointer-events: none; color: transparent; background-color: transparent; }`}copyCurrent(){return JSON.parse(JSON.stringify(this.typingList[this.order]))}resume(){this.play(!0),this.stop=!1}pause(){this.stop=!0}run(){this.isStarted=!0,this.render()}clear(){this.isStarted=!1}wait(e=0){return new Promise((t=>{this.stop?this.play=t:setTimeout((()=>{t(!0)}),1e3*e)}))}createEl(e,t){const n=document.createElement(e);return n.innerHTML=t,n}renderEraseDivide(e){return new Promise((t=>{const n=[...this.element.innerText].map((e=>this.createEl("span",e).outerHTML));let r=n.length,s=e.pop();const i=setInterval((async()=>{if(this.stop&&await this.wait(),0===s.length){if(0===e.length)return clearInterval(i),this.element.innerText="",void t(!0);s=e.pop(),r-=1,this.element.innerHTML="",this.element.innerHTML=n.slice(0,r).join("")}else this.element.innerHTML=[...n.slice(0,r-1),this.createEl("span",s.pop()).outerHTML].join("")}),1/this.config.speed.erase*100)}))}renderWriteDivide(e){return new Promise((t=>{let n=0;const r=[];let s=e.shift();const i=setInterval((async()=>{this.stop&&await this.wait(),0===s.length?0===e.length?(clearInterval(i),this.element.innerHTML=r.join(""),t(!0)):(s=e.shift(),n+=1):(r[n]=this.createEl("span",s.shift()).outerHTML,this.element.innerHTML=r.join(""))}),1/this.config.speed.write*100)}))}renderErase(e){return new Promise((t=>{let n=this.element.innerText.length;const r=this.element.innerText;let s=e.pop();const i=setInterval((async()=>{if(this.stop&&await this.wait(),0===s.length){if(0===e.length)return clearInterval(i),this.element.innerText="",void t(!0);s=e.pop(),n-=1,this.element.innerText=r.slice(0,n)}else this.element.innerText=r.slice(0,n-1)+s.pop()}),1/this.config.speed.erase*100)}))}renderWrite(e){return new Promise((t=>{let n=0;const r=[];let s=e.shift();const i=setInterval((async()=>{this.stop&&await this.wait(),0===s.length?0===e.length?(clearInterval(i),console.log("success wrote"),this.element.innerText=r.join(""),t(!0)):(s=e.shift(),n+=1):(r[n]=s.shift(),this.element.innerText=r.join(""))}),1/this.config.speed.write*100)}))}async render(){!1!==this.isStarted&&(this.orderUp(),this.config.mode.divide?(await this.renderWriteDivide([...this.copyCurrent()]),await this.wait(this.config.delay),this.config.mode.erase&&(await this.renderEraseDivide([...this.copyCurrent()]),await this.wait(this.config.delay))):(await this.renderWrite([...this.copyCurrent()]),await this.wait(this.config.delay),this.config.mode.erase&&(await this.renderErase([...this.copyCurrent()]),await this.wait(this.config.delay))),this.isStarted&&this.render())}}class r{}class s{onset=["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"];nucleus=["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ","ㅘ","ㅙ","ㅚ","ㅛ","ㅜ","ㅝ","ㅞ","ㅟ","ㅠ","ㅡ","ㅢ","ㅣ"];coda=["","ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"];gapLetterWithWord=18816;startKorPoint=12593;startKorWordPoint=44032;changeOnsetPoint=this.coda.length*this.nucleus.length;korInitializePoint(e){if(!this.isKorean(e))throw new TypeError("required only korean.");return e.charCodeAt(0)-this.startKorWordPoint}onsetIndex(e){return Math.floor(this.korInitializePoint(e)/this.changeOnsetPoint)}nucleusIndex(e){return Math.floor(this.korInitializePoint(e)/this.coda.length%this.nucleus.length)}codeIndex(e){return Math.floor(this.korInitializePoint(e)%this.coda.length)}getOnset(e){return this.onset[this.onsetIndex(e)]}getNucleus(e){return this.nucleus[this.nucleusIndex(e)]}getCoda(e){return this.coda[this.codeIndex(e)]}isKorean(e){return!!String(e).match(/[ㄱ-ㅎ가-힣]/g)}wordToLetters(e){return this.wordToLettersWithEmpty(e).filter((e=>e))}wordToLettersWithEmpty(e){return[this.getOnset(e),this.getNucleus(e),this.getCoda(e)]}getOnsetIndex(e){return this.onset.indexOf(e)}getNucleusIndex(e){return this.nucleus.indexOf(e)}getCodaIndex(e){return this.coda.indexOf(e)}getOnsetCode(e){return this.getOnsetIndex(e)*this.changeOnsetPoint}getNucleusCode(e){return this.getNucleusIndex(e)%this.nucleus.length*this.coda.length}getCodaCode(e){return this.getCodaIndex(e)%this.coda.length}getWordCode(e){let t=0;return e[0]&&(t+=this.getOnsetCode(e[0])),e[1]&&(t+=this.getNucleusCode(e[1])),e[2]&&(t+=this.getCodaCode(e[2])),t+this.startKorWordPoint}lettersToWord(e){const t=this.getWordCode(e),n=String.fromCharCode(t);return 1===e.length?e[0]:n}}class i extends r{koreanParser;constructor(){super(),this.koreanParser=new s}wordToLetters(e){return this.wordToLettersWithEmpty(e).filter((e=>e))}wordToLettersWithEmpty(e){return[e,"",""]}categorizing(e){const t=[];for(const n of e.trim())if(this.koreanParser.isKorean(n)){const e=this.koreanParser.wordToLetters(n);t.push(e)}else{const e=this.wordToLetters(n);t.push(e)}return t}categorizingWithEmpty(e){const t=[];for(const n of e)if(this.koreanParser.isKorean(n)){const e=this.koreanParser.wordToLettersWithEmpty(n);t.push(e)}else{const e=this.wordToLettersWithEmpty(n);t.push(e)}return t}getTypingFlow(e){return e.map((e=>{const t=[];if(e.some(this.koreanParser.isKorean))for(let n=1;n<=e.length;n++){const r=e.slice(0,n),s=this.koreanParser.lettersToWord(r);t.push(s)}else t.push(...e);return t}))}parse(e){if(""!==e){const t=this.categorizing(e);return this.getTypingFlow(t)}return[]}}class o{findElements(e){return document.querySelectorAll([].concat(e).join(","))}findOne(e){return document.querySelector(e)}createEl(e,t){const n=document.createElement(e);return n.innerHTML=t,n}trimInnerText(e){return e.innerText.trim()}initializeTypozStyle(e){const t=this.createEl("style",e);document.head.append(t)}}class a{defaultConfig={autoRender:!0,mode:{erase:!0,realTyping:!1,divide:!0},speed:{write:1,erase:1},delay:5,nodes:[],querySelector:".typoz"};parser;domManager;config;typingList=[];constructor(){this.parser=new i,this.domManager=new o}recursiveConfigApply(e,t){for(const n of Object.keys(t))"string"==typeof e[n]||"number"==typeof e[n]||"boolean"==typeof e[n]||e[n]instanceof Array?e[n]=t[n]:this.recursiveConfigApply(e[n],t[n])}initialize(){this.config=this.defaultConfig}globalConfig(e={autoRender:!0,mode:{erase:!0,realTyping:!1,divide:!0},speed:{write:1,erase:1},delay:5,nodes:[],querySelector:".typoz"}){e&&this.recursiveConfigApply(this.config,e),this.config.autoRender&&this.render()}convert(e){return this.parser.parse(e)}bulkConvert(e){const t=[];for(const n of e)t.push(this.convert(n));return t}getConfigNodes(){return this.config.nodes.length>0?this.config.nodes.reduce(((e,{select:t,words:n,config:r})=>{const s=this.domManager.findOne(t);if(s){if(!Object.hasOwn(s,"typozConfig")){const e=JSON.parse(JSON.stringify(this.defaultConfig));this.recursiveConfigApply(e,r||this.config),s.typozConfig=e}const t=this.domManager.trimInnerText(s);""!==t&&(Object.hasOwn(s,"typings")||(s.typings=[]),s.typings.push(this.convert(t)),n.length>0&&s.typings.push(...this.bulkConvert(n)),e.push(s))}else console.error(new SyntaxError("not found element.",{cause:t}));return e}),[]):[]}resume(e){if(null!=e&&"string"==typeof e){const t=this.typingList.find((t=>t.name===e));t&&t.resume()}else for(const e of this.typingList)e.resume()}pause(e){if(null!=e&&"string"==typeof e){const t=this.typingList.find((t=>t.name===e));t&&t.pause()}else for(const e of this.typingList)e.pause()}render(e){const t=[];let r="",s=0;if(e)e instanceof Array?t.push(...e):t.push(e);else{const e=this.domManager.findElements(this.config.querySelector);t.push(...e)}t.push(...this.getConfigNodes());for(const e of[...new Set(t)]){const t=++s,i=[this.convert(e.innerText.trim())];e.typings?.length>0&&i.push(...e.typings);const o=new n(t,e,e.typozConfig,i);r+=o.injectStyle+"\n",this.typingList.push(o),o.run()}this.domManager.initializeTypozStyle(r)}}const h=a;return t})()));